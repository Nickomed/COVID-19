\documentclass[a4paper,11pt]{article}
\usepackage{luatex85}
\usepackage[babelshorthands]{polyglossia}
%\usepackage[utf8]{inputenc}
%\usepackage[russian]{babel}
\usepackage[fleqn,reqno]{amsmath}
\usepackage[width=16cm,height=24cm]{geometry}
\usepackage{unicode-math}
\usepackage{microtype}
\usepackage[russian]{hyperref}

\def\[#1\]{\begin{align*}#1\end{align*}}
\newcommand\eqtag[1]{\refstepcounter{equation}\tag{\theequation}\label{#1}}

\setmainlanguage{russian}

\setmainfont{Cambria}
\setsansfont{Calibri}
\setmonofont{Source Code Pro}[Scale=MatchLowercase]
\setmonofont{Source Code Pro}[Scale=MatchLowercase]
\setmathfont{Cambria Math}[sans-style=literal]
\setmathfont{XITS Math}[range={\mathscr}]

\title{Эллипсоидальные координаты и геодезические на трехосном эллипсоиде}
\author{Пицын Сергей}
\date{Апрель 2020}

\usepackage{natbib}
\usepackage{graphicx}
\usepackage{amsmath}
%\usepackage{dsfont}


\begin{document}

\maketitle

\section{Постановка задачи}

Пусть эллипсоид в~трехмерном пространстве $\BbbR^3$ задан уравнением
	\[
	\frac{x_1^2}{a_1}+\frac{x_2^2}{a_2}+\frac{x_3^2}{a_3}=1,
	\eqtag{eq:ellipsioid}
	\]
где $0<a_1<a_2<a_3$~— квадраты главных полуосей (такие эллипсоиды, где
все квадраты главных полуосей попарно неравны, называются трехосными).

Рассмотрим движение точки единичной массы по инерции по этому эллипсоиду.
Так~как движение происходит без воздействия каких"=либо сил, то силовая функция
$U = 0$. Тогда
	\[
	L=\frac12(\dot x_1^2+\dot x_2^2+\dot x_3^2).
	\eqtag{eq:lagrangian}
	\]

Наша цель~— показать, что существует замена координат, при которой переменные
в~этой задаче разделяются. Такая замена, соответственно, позволит эту задачу
проинтегрировать и~получить уравнения движения материальной точки, а, как
следствие, и~уравнения геодезических на трехосном эллипсоиде. 

\section{Эллипсоидальные координаты}

Рассмотрим уравнение
	\[
	f(\lambda)=\frac{x_1^2}{a_1+\lambda}+\frac{x_2^2}{a_2+\lambda}+\frac{x_3^2}{a_3+\lambda}=1,
	\]
где $a_i$~— все те~же квадраты главных полуосей эллипсоида. Докажем, что корни
этого уравнения вещественны. В~самом деле, в~интервале $(-\infty,-a_3)$
$f(\lambda)$ очевидно отрицательна, а~значит, корней в~этом интервале нету.
Когда $\lambda$ пробегает интервал $(-a_3,-a_2)$, $f(\lambda)$ монотонно
пробегает интервал $(-\infty,+\infty)$. Таким образом, в интервале
$(-a_3,-a_2)$ найдется корень, и~притом только один. Аналогично в~интервале
$(-a_2,-a_1)$ есть единственный корень. Далее, когда $\lambda$ пробегает
интервал $(-a_1,+\infty)$, $f(\lambda)$ монотонно уменьшается в интервале
$(+\infty,0)$. Следовательно и~в~этом интервале будет единственная точка, где
$f(\lambda)$ примет значение~$1$, то есть корень.

Обозначим эти корни $\lambda_1,\lambda_2,\lambda_3$ и~пусть
$\lambda_1<\lambda_2<\lambda_3$. Они-то и~называются эллипсоидальными
координатами. Таким образом, получаем:
	\[
	&\frac{x_1^2}{a_1+\lambda_1}+\frac{x_2^2}{a_2+\lambda_1}+\frac{x_3^2}{a_3+\lambda_1}=1,\\
	&\frac{x_1^2}{a_1+\lambda_2}+\frac{x_2^2}{a_2+\lambda_2}+\frac{x_3^2}{a_3+\lambda_2}=1,\\
	&\frac{x_1^2}{a_1+\lambda_3}+\frac{x_2^2}{a_2+\lambda_3}+\frac{x_3^2}{a_3+\lambda_3}=1.
	\]
Выразим декартовы координаты через эллипсоидальные. Для этого домножим первое
уравнение на $a_3+\lambda_1$ и~вычтем из него второе, домноженное на
$a_3+\lambda_2$. Получим:
	\[
	x_1^2\left(\frac{a_3+\lambda_2}{a_1+\lambda_1}-\frac{a_3+\lambda_1}{a_1+\lambda_2}\right)
		+x_2^2\left(\frac{a_3+\lambda_2}{a_2+\lambda_1}-\frac{a_3+\lambda_1}{a_2+\lambda_2}\right)
		=\lambda_2-\lambda_1,
	\]
или, после сокращений
	\[
	\frac{a_1-a_3}{(a_1+\lambda_1)(a_1+\lambda_2)}x_1^2+\frac{a_2-a_3}{(a_2+\lambda_1)(a_2+\lambda_2)}x_2^2=1.
	\]
Проделав аналогичную операцию с~первым и третьим уравнением в~системе, получим
систему с~исключенной переменной $x_3$:
	\[
	&\frac{a_1-a_3}{(a_1+\lambda_1)(a_1+\lambda_2)}x_1^2+\frac{a_2-a_3}{(a_2+\lambda_1)(a_2+\lambda_2)}x_2^2=1,\\
	&\frac{a_1-a_3}{(a_1+\lambda_1)(a_1+\lambda_3)}x_1^2+\frac{a_2-a_3}{(a_2+\lambda_1)(a_2+\lambda_3)}x_2^2=1.
	\]
Аналогично исключаем переменную $x_2$ из нее, и получаем одно уравнение:
	\[
	\frac{(a_1-a_3)(a_1-a_2)}{(a_1+\lambda_1)(a_1+\lambda_2)(a_1+\lambda_3)}x_1^2=1,
	\]
откуда
	\[
	x_1^2=\frac{(a_1+\lambda_1)(a_1+\lambda_2)(a_1+\lambda_3)}{(a_1-a_3)(a_1-a_2)}.
	\]
Для $x_2^2$ и $x_3^2$, очевидно, будут иметь место аналогичные формулы, которые
получаются с~помощью точно таких~же манипуляций. Итого:
	\[
	&x_1^2=\frac{(a_1+\lambda_1)(a_1+\lambda_2)(a_1+\lambda_3)}{(a_1-a_3)(a_1-a_2)},\\
	&x_2^2=\frac{(a_2+\lambda_1)(a_2+\lambda_2)(a_2+\lambda_3)}{(a_2-a_3)(a_2-a_1)},\\
	&x_3^2=\frac{(a_3+\lambda_1)(a_3+\lambda_2)(a_3+\lambda_3)}{(a_3-a_2)(a_3-a_1)}.
	\]
Так мы выразили старые декартовы координаты через новые эллипсоидальные. Это
замечательно. Добавим, кстати, что исходный эллипсоид в~эллипсоидальных
координатах будет задаваться уравнением $\lambda_3=0$ (единственная лямбда,
которая может быть неотрицательной, самая большая), так~как в~этом случае как
раз и~получается уравнение исходного эллипсоида~\eqref{eq:ellipsioid}.
А~$\lambda_1$ и~$\lambda_2$ в~этом случае зададут на нем систему координат.

\textit{Лирическое отступление:} Легко заметить, что, полагая
$\lambda_3=\symup{const}$, получаем какой"=то эллипсоид. Если положить
$\lambda_2=\symup{const}$, то легко понять, что получится однополосный
гиперболоид, а при $\lambda_1=\symup{const}$ гиперболоид будет двуполосным. Это
явно следует из расположения корней $f(\lambda)$ на числовой оси относительно
чисел $a_1$, $a_2$ и~$a_3$. И~это довольно симпатично.

\section{Решение задачи}

Наша ближайшая цель~— посчитать функцию Лагранжа~\eqref{eq:lagrangian}
в~эллипсоидальных координатах. Для этого
воспользуемся трюком, а~именно: возьмем выведенное ранее выражение через
эллипсоидальные координаты, например, для $x_1^2$ и~возьмем от обеих частей
логарифм. Получим: $2\ln(x_1)=\sum_{i=1}^{3}\ln(a_1+\lambda_i)+\symup{const}$.
Теперь продифференцируем обе части по~$t$ (здесь есть зависимость от~$t$, т.~к.
теперь $x_i$ понимаем как координаты точки при движении). Получим:
	\[
	\frac{2\dot x_1}{x_1}=\frac{\dot\lambda_1}{a_1+\lambda_1}
		+\frac{\dot\lambda_2}{a_1+\lambda_2}+\frac{\dot\lambda_3}{a_1+\lambda_3}
		=\frac{\dot\lambda_1}{a_1+\lambda_1}+\frac{\dot\lambda_2}{a_1+\lambda_2},
	\]
так~как $\lambda_3=0$. Возведем обе части в квадрат и~домножим на $x_1^2$. Тогда получим:
	\[
	4\dot x_1^2=\frac{x_1^2\dot\lambda_1^2}{(a_1+\lambda_1)^2}
		+\frac{x_1^2\dot\lambda_2^2}{(a_1+\lambda_2)^2}
		+\frac{2x_1^2\dot\lambda_1\dot\lambda_2}{(a_1+\lambda_1)(a_1+\lambda_2)}.
	\]
Проделаем аналогичные выкладки с~выражениями для $x_2$ и~$x_3$ и~сложим три
полученных равенства. Итого:
	\[
	\dot x_1^2+\dot x_2^2+\dot x_3^2
		=\frac14\left[\sum_{i=1}^3\left(\frac{x_i^2\dot\lambda_1^2}{(a_i+\lambda_1)^2}
		+\frac{x_i^2\dot\lambda_2}{(a_i+\lambda_2)^2}\right)
		+\sum_{i=1}^3\frac{2x_i^2\dot\lambda_1\dot\lambda_2}{(a_i+\lambda_1)(a_i+\lambda_2)}\right]=2L.
	\]
Теперь подставим вместо $x_i$ их выражения через $\lambda_1$ и~$\lambda_2$
и~получим то, что надо.

Давайте подставим сначала в
	\[
	\sum_{i=1}^3\frac{2x_i^2\dot{\lambda_1}\dot{\lambda_2}}{(a_i+\lambda_1)(a_i+\lambda_2)}.
	\]
Легко видеть, что после подстановки и~сокращений получается
	\[
	2\dot\lambda_1\dot\lambda_2\left(
		\frac{a_1}{(a_1-a_3)(a_1-a_2)}+\frac{a_2}{(a_2-a_1)(a_2-a_3)}+\frac{a_3}{(a_3-a_1)(a_3-a_2)}\right)=0.
	\]
Замечательно!

Теперь подставим во все остальное. Тогда получим:
	\[
	L=\frac18(M_1(\lambda_1,\lambda_2)\dot\lambda_1^2+M_2(\lambda_1,\lambda_2)\dot\lambda_2^2),
	\]
где
	\[
	M_1(\lambda_1,\lambda_2)=\frac{\lambda_1(\lambda_1-\lambda_2)}{(a_1+\lambda_1)(a_2+\lambda_1)(a_3+\lambda_1)},
	\quad
	M_2(\lambda_1,\lambda_2)=\frac{\lambda_2(\lambda_2-\lambda_1)}{(a_1+\lambda_2)(a_2+\lambda_2)(a_3+\lambda_2)}
	\]
не зависят от $\dot\lambda_1$ и $\dot\lambda_2$.

Как мы видим, относительно переменных $\dot\lambda_1$ и~$\dot\lambda_2$
функция $L$ является однородной степени $2$, а значит по теореме Эйлера
получаем, что после преобразования Лежандра относительно переменных
$\dot\lambda_1$ и~$\dot\lambda_2$ функция $L$ не изменится.
	\[
	p_1=\frac{\partial L}{\partial\dot\lambda_1}=\frac{(\lambda_1-\lambda_2)\lambda_1\dot\lambda_1}{4(a_1+\lambda_1)(a_2+\lambda_1)(a_3+\lambda_1)},
	\quad
	p_2=\frac{\partial L}{\partial\dot\lambda_2}=\frac{(\lambda_2-\lambda_1)\lambda_2\dot\lambda_2}{4(a_1+\lambda_2)(a_2+\lambda_2)(a_3+\lambda_2)}.
	\]
И тогда
	\[
	H=\frac2{\lambda_1-\lambda_2}(g(\lambda_1)p_1^2+g(\lambda_2)p_2^2).
	\]
То~есть видно, что переменные в~эллипсоидальных координатах разделились, как мы
и~хотели. Ура!

Дальше, как и~говорилось в~начале, задачу можно проинтегрировать и получить
уравнения движения и геодезические, но явный вид закона получится слишком
сложный и~не слишком интересный, поэтому лучше остановимся на приятном.






\bibliographystyle{plain}
\begin{thebibliography}{9}
\bibitem{}
К.~Якоби. Лекции по динамике.

\bibitem{}
А.~В.~Борисов, И.~С. Мамаев. Динамика твердого тела.
\end{thebibliography}
\end{document}
